"use strict";(self.webpackChunkn2_compile=self.webpackChunkn2_compile||[]).push([[66128],{66128:(e,l,n)=>{n.d(l,{Q:()=>y,getRampStops:()=>g,p:()=>m});var t=n(51995),i=n(51508),o=n(4075),s=n(49729),a=n(74579),r=n(75434),u=(n(80975),n(37384)),c=n(16072),f=n(16851);const m=30,y=12,p=[255,255,255],h=[200,200,200],b=[128,128,128],d=20,w=5;async function g(e,l,n,t,i,s,u){const c=l.legendOptions,f=c?.customValues,m=u||await z(e,n),y=l.stops,p=!!m,h=!!f,b=null!=l.minSize&&null!=l.maxSize,d=y&&y.length>1,w=!!l.target;if(!p||!h&&!(b||d&&!w))return;const g=(0,a.YW)(m);let k=!1,x=null,C=null;x=g&&!d?(0,o.NM)([l.minDataValue,l.maxDataValue]):f??await M(l,m,t,i?.type);const I=e?.authoringInfo,N="univariate-color-size"===I?.type,P=N&&"above-and-below"===I?.univariateTheme;if(!x&&d&&(x=y.map((e=>e.value)),k=y.some((e=>!!e.label)),"flow"===e.type&&(x=(0,o.NM)(x)),k&&(C=y.map((e=>e.label)))),g&&null!=x&&x?.length>2&&!P&&(x=[x[0],x[x.length-1]]),!x)return null;N&&5!==x?.length&&(x=V({minSize:x[0],maxSize:x[x.length-1]}));const Z=g?v(e,x):null,B=(0,a.Y6)(m),E=k?null:function(e,l){const n=e.length-1;return e.map(((e,t)=>(0,r.MN)(e,t,n,l)))}(x,s);return(await Promise.all(x.map((async(n,o)=>{const s=g?Z[o]:await D(l,m,n,t,i?.type);return{value:n,symbol:L(P&&"class-breaks"===e.type?S(e,o):m,s),label:k?C[o]:E[o],size:s,outlineSize:B}})))).reverse()}function v(e,l){const n=e?.authoringInfo,t="univariate-color-size"===n?.type;let i=[y,m];if(t){const e=l[0],n=l[l.length-1],t=y,o=m;i=l.map((l=>t+(l-e)/(n-e)*(o-t)))}return t&&"below"===n?.univariateTheme&&i.reverse(),i}function S(e,l){const n=e.classBreakInfos,t=n.length,i=t<2||!(l>=2)?n[0].symbol.clone():n[t-1].symbol.clone();return e.visualVariables.some((e=>"color"===e.type))&&(i.type.includes("3d")?k(i):x(i)),i}async function z(e,l){if("flow"===e.type)return(0,r.y$)(e,l);if("pie-chart"===e.type)return new c.Z({color:null,outline:e.outline?.width?e.outline:new f.Z});let n=null,t=null;if("simple"===e.type)n=e.symbol;else if("class-breaks"===e.type){const l=e.classBreakInfos;n=l&&l[0]&&l[0].symbol,t=l.length>1}else if("unique-value"===e.type){const l=e.uniqueValueInfos;n=l?.[0]?.symbol,t=null!=l&&l.length>1}return!n||function(e){if(e)return(0,i.dU)(e)?!!e.symbolLayers&&e.symbolLayers.some((e=>e&&"fill"===e.type)):e.type.includes("fill");return!1}(n)?null:(n=n.clone(),(l||t)&&(n.type.includes("3d")?k(n):x(n)),n)}function k(e){"line-3d"===e.type?e.symbolLayers.forEach((e=>{e.material={color:b}})):e.symbolLayers.forEach((e=>{"icon"!==e.type||e.resource?.href?e.material={color:h}:(e.material={color:p},e.outline={color:b,size:1.5})}))}function x(e){const l=(0,u.$o)();if("cim"===e.type)(0,s.ZB)(e,new t.Z(h));else if(e.type.includes("line"))e.color=b;else if(e.color=l?b:p,"simple-marker"===e.type)if(e.outline){const l=e.outline?.color?.toHex();"#ffffff"===l&&(e.outline.color=b)}else e.outline={color:b,width:1.5}}async function M(e,l,t,i){const s=(await Promise.resolve().then(n.bind(n,56011))).getSizeRangeAtScale(e,t,i),a=s&&V(s);if(!s||!a)return;let r=a.map((l=>function(e,l,n){const t=n.minSize,i=n.maxSize,o=l.minDataValue,s=l.maxDataValue;let a;a=e<=t?o:e>=i?s:(e-t)/(i-t)*(s-o)+o;return a}(l,e,s)));r=(0,o.NM)(r);for(let n=1;n<r.length-1;n++){const o=await C(e,l,r[n],r[n-1],t,i);o&&(r[n]=o[0],a[n]=o[1])}return r}function V(e){const l=e.minSize,n=e.maxSize,t=w,i=(n-l)/(t-1),o=[];for(let s=0;s<t;s++)o.push(l+i*s);return o}async function C(e,l,n,t,i,s){const a=await D(e,l,n,i,s),r=await D(e,l,t,i,s),u=(0,o.D2)(n),c=u.fractional,f=d;let m=u.integer,y=null,p=null;n>0&&n<1&&(y=10**c,m=(0,o.D2)(n*=y).integer);for(let h=m-1;h>=0;h--){const t=10**h;let u=Math.floor(n/t)*t,c=Math.ceil(n/t)*t;null!=y&&(u/=y,c/=y);let m=(u+c)/2;[,m]=(0,o.NM)([u,m,c],{indexes:[1]});const b=await D(e,l,u,i,s),d=await D(e,l,c,i,s),w=await D(e,l,m,i,s),g=(0,o.f1)(a,b,r,null),v=(0,o.f1)(a,d,r,null),S=(0,o.f1)(a,w,r,null);let z=g.previous<=f,k=v.previous<=f;if(z&&k&&(g.previous<=v.previous?(z=!0,k=!1):(k=!0,z=!1)),z?p=[u,b]:k?p=[c,d]:S.previous<=f&&(p=[m,w]),p)break}return p}async function D(e,l,t,i,o){const{getSize:s}=await Promise.resolve().then(n.bind(n,56011));return s(e,t,{scale:i,view:o,shape:"simple-marker"===l.type?l.style:null})}function L(e,l){const n=e.clone();if((0,i.dU)(n))(0,a.YW)(n)||n.symbolLayers.forEach((e=>{"fill"!==e.type&&(e.size=l)}));else if(function(e){return"esri.symbols.SimpleMarkerSymbol"===e.declaredClass}(n))n.size=l;else if(function(e){return"esri.symbols.PictureMarkerSymbol"===e.declaredClass}(n)){const e=n.width,t=n.height;n.height=l,n.width=l*(e/t)}else!function(e){return"esri.symbols.SimpleLineSymbol"===e.declaredClass}(n)?function(e){return"esri.symbols.TextSymbol"===e.declaredClass}(n)&&n.font&&(n.font.size=l):n.width=l;return n}}}]);
//# sourceMappingURL=66128.03a32905.chunk.js.map