"use strict";(self.webpackChunkn2_compile=self.webpackChunkn2_compile||[]).push([[61491,92463,2170],{35582:(e,t,i)=>{i.d(t,{M:()=>u,b:()=>c});var r=i(41012),s=i(95276),n=i(58406),a=i(98634),o=i(64201),l=i(4760);function c(e){const t=new o.kG,{vertex:i,fragment:c}=t;(0,r.Sv)(i,e),i.uniforms.add(new n.p("width",(e=>e.width))),t.attributes.add(l.T.POSITION,"vec3"),t.attributes.add(l.T.NORMAL,"vec3"),t.attributes.add(l.T.UV0,"vec2"),t.attributes.add(l.T.LENGTH,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.code.add(a.H`void main(void) {
vec3 bitangent = normal;
vtc = uv0;
vlength = length;
vradius = 0.5 * width;
vec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);
gl_Position = proj * pos;
}`),c.uniforms.add(new n.p("outlineSize",(e=>e.outlineSize)),new s.N("outlineColor",(e=>e.outlineColor)),new n.p("stripeLength",(e=>e.stripeLength)),new s.N("stripeEvenColor",(e=>e.stripeEvenColor)),new s.N("stripeOddColor",(e=>e.stripeOddColor)));const u=1/Math.sqrt(2);return c.code.add(a.H`
    const float INV_SQRT2 = ${a.H.float(u)};

    vec4 arrowColor(vec2 tc, float len) {
      float d = INV_SQRT2 * (tc.x - abs(tc.y));
      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));
      d = min(d, 1.0 - abs(tc.y));

      if (d < 0.0) {
        return vec4(0.0);
      } else if (d < outlineSize) {
        return outlineColor;
      } else {
        return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;
      }
    }

    void main(void) {
      vec2 ntc = vec2(vtc.x / vradius, vtc.y);
      vec4 color = arrowColor(ntc, vlength / vradius);
      if (color.a == 0.0) {
        discard;
      }
      fragColor = color;
    }
  `),t}const u=Object.freeze(Object.defineProperty({__proto__:null,build:c},Symbol.toStringTag,{value:"Module"}))},47898:(e,t,i)=>{i.d(t,{GJ:()=>a,hw:()=>c,mE:()=>l,ne:()=>n,nn:()=>o,yG:()=>s});var r=i(68860);function s(e,t){return{type:(0,r.UF)(t),value:e,unit:t}}function n(e,t){return{type:(0,r.UF)(t),value:e,unit:t}}function a(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"arithmetic";return{type:(0,r.UF)(t),value:e,unit:t,rotationType:i}}function o(e,t){const i=l(e,t);return"angle"===e.type?a(i,t,e.rotationType):function(e,t){return{type:(0,r.UF)(t),value:e,unit:t}}(i,t)}function l(e,t){return(0,r.En)(e.value,e.unit,t)}function c(e,t,i){if(t===i)return e;switch(i){case"arithmetic":case"geographic":return 90-e}}s(0,"meters"),n(0,"square-meters"),a(0,"radians"),a(0,"degrees"),a(0,"degrees","geographic")},92463:(e,t,i)=>{i.r(t),i.d(t,{hydratedAdapter:()=>l});var r=i(53866),s=i(77577),n=i(585),a=i(80885),o=i(29909);const l={convertToGEGeometry:function(e,t){if(null==t)return null;let i="cache"in t?t.cache._geVersion:void 0;return null==i&&(i=e.convertJSONToGeometry(t),"cache"in t&&(t.cache._geVersion=i)),i},exportPoint:function(e,t,i){const r=e.hasZ(t),s=e.hasM(t),a=new n.Z({x:e.getPointX(t),y:e.getPointY(t),spatialReference:i});return r&&(a.z=e.getPointZ(t)),s&&(a.m=e.getPointM(t)),a.cache._geVersion=t,a},exportPolygon:function(e,t,i){const r=new a.Z({rings:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return r.cache._geVersion=t,r},exportPolyline:function(e,t,i){const r=new o.Z({paths:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:i});return r.cache._geVersion=t,r},exportMultipoint:function(e,t,i){const r=new s.Z({hasZ:e.hasZ(t),hasM:e.hasM(t),points:e.exportPoints(t),spatialReference:i});return r.cache._geVersion=t,r},exportExtent:function(e,t,i){const s=e.hasZ(t),n=e.hasM(t),a=new r.Z({xmin:e.getXMin(t),ymin:e.getYMin(t),xmax:e.getXMax(t),ymax:e.getYMax(t),spatialReference:i});if(s){const i=e.getZExtent(t);a.zmin=i.vmin,a.zmax=i.vmax}if(n){const i=e.getMExtent(t);a.mmin=i.vmin,a.mmax=i.vmax}return a.cache._geVersion=t,a}}},2170:(e,t,i)=>{i.r(t),i.d(t,{buffer:()=>S,changeDefaultSpatialReferenceTolerance:()=>Z,clearDefaultSpatialReferenceTolerance:()=>k,clip:()=>o,contains:()=>c,convexHull:()=>w,crosses:()=>u,cut:()=>l,densify:()=>j,difference:()=>M,disjoint:()=>m,distance:()=>h,equals:()=>d,extendedSpatialReferenceInfo:()=>a,flipHorizontal:()=>x,flipVertical:()=>T,generalize:()=>V,geodesicArea:()=>H,geodesicBuffer:()=>G,geodesicDensify:()=>U,geodesicLength:()=>q,intersect:()=>C,intersectLinesToPoints:()=>Y,intersects:()=>_,isSimple:()=>f,nearestCoordinate:()=>z,nearestVertex:()=>O,nearestVertices:()=>D,offset:()=>P,overlaps:()=>v,planarArea:()=>N,planarLength:()=>F,relate:()=>y,rotate:()=>E,simplify:()=>b,symmetricDifference:()=>R,touches:()=>p,union:()=>A,within:()=>g});var r=i(99058),s=i(92463);function n(e){return Array.isArray(e)?e[0].spatialReference:e&&e.spatialReference}function a(e){return r.G.extendedSpatialReferenceInfo(e)}function o(e,t){return r.G.clip(s.hydratedAdapter,n(e),e,t)}function l(e,t){return r.G.cut(s.hydratedAdapter,n(e),e,t)}function c(e,t){return r.G.contains(s.hydratedAdapter,n(e),e,t)}function u(e,t){return r.G.crosses(s.hydratedAdapter,n(e),e,t)}function h(e,t,i){return r.G.distance(s.hydratedAdapter,n(e),e,t,i)}function d(e,t){return r.G.equals(s.hydratedAdapter,n(e),e,t)}function _(e,t){return r.G.intersects(s.hydratedAdapter,n(e),e,t)}function p(e,t){return r.G.touches(s.hydratedAdapter,n(e),e,t)}function g(e,t){return r.G.within(s.hydratedAdapter,n(e),e,t)}function m(e,t){return r.G.disjoint(s.hydratedAdapter,n(e),e,t)}function v(e,t){return r.G.overlaps(s.hydratedAdapter,n(e),e,t)}function y(e,t,i){return r.G.relate(s.hydratedAdapter,n(e),e,t,i)}function f(e){return r.G.isSimple(s.hydratedAdapter,n(e),e)}function b(e){return r.G.simplify(s.hydratedAdapter,n(e),e)}function w(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.G.convexHull(s.hydratedAdapter,n(e),e,t)}function M(e,t){return r.G.difference(s.hydratedAdapter,n(e),e,t)}function R(e,t){return r.G.symmetricDifference(s.hydratedAdapter,n(e),e,t)}function C(e,t){return r.G.intersect(s.hydratedAdapter,n(e),e,t)}function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return r.G.union(s.hydratedAdapter,n(e),e,t)}function P(e,t,i,a,o,l){return r.G.offset(s.hydratedAdapter,n(e),e,t,i,a,o,l)}function S(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r.G.buffer(s.hydratedAdapter,n(e),e,t,i,a)}function G(e,t,i,a,o,l){return r.G.geodesicBuffer(s.hydratedAdapter,n(e),e,t,i,a,o,l)}function z(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return r.G.nearestCoordinate(s.hydratedAdapter,n(e),e,t,i)}function O(e,t){return r.G.nearestVertex(s.hydratedAdapter,n(e),e,t)}function D(e,t,i,a){return r.G.nearestVertices(s.hydratedAdapter,n(e),e,t,i,a)}function L(e){return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e?e.extent?.center??null:null}function E(e,t,i){if(null==e)throw new W;const s=e.spatialReference;if(null==(i=i??L(e)))throw new W;const n=e.constructor.fromJSON(r.G.rotate(e,t,i));return n.spatialReference=s,n}function x(e,t){if(null==e)throw new W;const i=e.spatialReference;if(null==(t=t??L(e)))throw new W;const s=e.constructor.fromJSON(r.G.flipHorizontal(e,t));return s.spatialReference=i,s}function T(e,t){if(null==e)throw new W;const i=e.spatialReference;if(null==(t=t??L(e)))throw new W;const s=e.constructor.fromJSON(r.G.flipVertical(e,t));return s.spatialReference=i,s}function V(e,t,i,a){return r.G.generalize(s.hydratedAdapter,n(e),e,t,i,a)}function j(e,t,i){return r.G.densify(s.hydratedAdapter,n(e),e,t,i)}function U(e,t,i){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return r.G.geodesicDensify(s.hydratedAdapter,n(e),e,t,i,a)}function N(e,t){return r.G.planarArea(s.hydratedAdapter,n(e),e,t)}function F(e,t){return r.G.planarLength(s.hydratedAdapter,n(e),e,t)}function H(e,t,i){return r.G.geodesicArea(s.hydratedAdapter,n(e),e,t,i)}function q(e,t,i){return r.G.geodesicLength(s.hydratedAdapter,n(e),e,t,i)}function Y(e,t){return r.G.intersectLinesToPoints(s.hydratedAdapter,n(e),e,t)}function Z(e,t){r.G.changeDefaultSpatialReferenceTolerance(e,t)}function k(e){r.G.clearDefaultSpatialReferenceTolerance(e)}class W extends Error{constructor(){super("Illegal Argument Exception")}}},15559:(e,t,i)=>{i.d(t,{Gb:()=>_,Jf:()=>g,Lc:()=>b,TB:()=>y,_q:()=>v,cA:()=>f,j2:()=>m,p8:()=>p});i(59486);var r=i(10064),s=i(68860),n=i(38516),a=i(92975),o=i(29909),l=i(80885),c=(i(585),i(78952));function u(e){if(!e)return null;if((0,a.sT)(e)&&e.wkid){const t=n.Dg[e.wkid];if(t)return t}const t=e.wkt2||e.wkt;if(t){const e=function(e){const t=n.FQ.exec(e);if(!t||2!==t.length)return null;const i=t[1].split(",");if(!i||i.length<3)return null;const r=parseFloat(i[1]),s=parseFloat(i[2]);return isNaN(r)||isNaN(s)?null:{a:r,f:0===s?0:1/s}}(t);if(e)return e}return null}function h(e){const t=u(e);if(function(e){return null!=e&&"b"in e&&"eSq"in e&&"radius"in e}(t))return t;const i=t.a*(1-t.f);return Object.assign(t,{b:i,eSq:1-(i/t.a)**2,radius:(2*t.a+i)/3,densificationRatio:1e4/((2*t.a+i)/3)})}function d(e,t,i){const{a:r,eSq:s}=h(i),a=Math.sqrt(s),o=Math.sin(t[1]*n.Yr),l=r*t[0]*n.Yr;let c;return c=s>0?r*((1-s)*(o/(1-s*(o*o))-1/(2*a)*Math.log((1-a*o)/(1+a*o))))*.5:r*o,e[0]=l,e[1]=c,e}function _(e){return null!==u(e)}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"square-meters";if(e.some((e=>!_(e.spatialReference))))throw new r.Z("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let r=0;r<e.length;r++){const t=e[r],s=t.spatialReference,{radius:n,densificationRatio:a}=h(s),o=n*a;i.push(m(t,o))}const n=[],a=[0,0],o=[0,0];for(let r=0;r<i.length;r++){const{rings:e,spatialReference:l}=i[r];let c=0;for(let t=0;t<e.length;t++){const i=e[t];d(a,i[0],l),d(o,i[i.length-1],l);let r=o[0]*a[1]-a[0]*o[1];for(let e=0;e<i.length-1;e++)d(a,i[e+1],l),d(o,i[e],l),r+=o[0]*a[1]-a[0]*o[1];c+=r}c=(0,s.En)(c,"square-meters",t),n.push(c/-2)}return n}function g(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"meters";if(!e)throw new r.Z("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(e.some((e=>!_(e.spatialReference))))throw new r.Z("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let r=0;r<e.length;r++){const n=e[r],{spatialReference:a}=n,o="polyline"===n.type?n.paths:n.rings;let l=0;for(let e=0;e<o.length;e++){const t=o[e];let i=0;for(let e=1;e<t.length;e++){const r=t[e-1][0],s=t[e][0],n=t[e-1][1],o=t[e][1];if(n!==o||r!==s){const e=new v;f(e,[r,n],[s,o],a),i+=e.distance}}l+=i}l=(0,s.En)(l,"meters",t),i.push(l)}return i}function m(e,t){if("polyline"!==e.type&&"polygon"!==e.type)throw new r.Z("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=e;if(!_(i))throw new r.Z("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const s="polyline"===e.type?e.paths:e.rings,n=[],a=[0,0],c=new v;for(const r of s){const e=[];n.push(e),e.push([r[0][0],r[0][1]]);let s,o,l=r[0][0],u=r[0][1];for(let n=0;n<r.length-1;n++){if(s=r[n+1][0],o=r[n+1][1],l===s&&u===o)continue;const h=[l,u];f(c,[l,u],[s,o],i);const{azimuth:d,distance:_}=c,p=_/t;if(p>1){for(let r=1;r<=p-1;r++)y(a,h,d,r*t,i),e.push(a.slice(0));y(a,h,d,(_+Math.floor(p-1)*t)/2,i),e.push(a.slice(0))}y(a,h,d,_,i),e.push(a.slice(0)),l=a[0],u=a[1]}}return"polyline"===e.type?new o.Z({paths:n,spatialReference:i}):new l.Z({rings:n,spatialReference:i})}class v{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.distance=e,this.azimuth=t,this.reverseAzimuth=i}}function y(e,t,i,r,s){const a=t[0],o=t[1],l=a*n.Yr,c=o*n.Yr,u=(i??0)*n.Yr,{a:d,b:_,f:p}=h(s),g=Math.sin(u),m=Math.cos(u),v=(1-p)*Math.tan(c),y=1/Math.sqrt(1+v*v),f=v*y,b=Math.atan2(v,m),w=y*g,M=w*w,R=1-M,C=R*(d*d-_*_)/(_*_),A=1+C/16384*(4096+C*(C*(320-175*C)-768)),P=C/1024*(256+C*(C*(74-47*C)-128));let S,G,z,O,D=r/(_*A),L=2*Math.PI;for(;Math.abs(D-L)>1e-12;)z=Math.cos(2*b+D),S=Math.sin(D),G=Math.cos(D),O=P*S*(z+P/4*(G*(2*z*z-1)-P/6*z*(4*S*S-3)*(4*z*z-3))),L=D,D=r/(_*A)+O;const E=f*S-y*G*m,x=Math.atan2(f*G+y*S*m,(1-p)*Math.sqrt(M+E*E)),T=Math.atan2(S*g,y*G-f*S*m),V=p/16*R*(4+p*(4-3*R)),j=x/n.Yr,U=(l+(T-(1-V)*p*w*(D+V*S*(z+V*G*(2*z*z-1)))))/n.Yr;return e[0]=U,e[1]=j,e}function f(e,t,i,r){const s=t[0]*n.Yr,a=t[1]*n.Yr,o=i[0]*n.Yr,l=i[1]*n.Yr,{a:c,b:u,f:d,radius:_}=h(r),p=o-s,g=Math.atan((1-d)*Math.tan(a)),m=Math.atan((1-d)*Math.tan(l)),v=Math.sin(g),y=Math.cos(g),f=Math.sin(m),b=Math.cos(m);let w,M,R,C,A,P,S,G,z,O,D=1e3,L=p;do{if(S=Math.sin(L),G=Math.cos(L),R=Math.sqrt(b*S*(b*S)+(y*f-v*b*G)*(y*f-v*b*G)),0===R)return e.distance=0,e.azimuth=void 0,e.reverseAzimuth=void 0,e;A=v*f+y*b*G,P=Math.atan2(R,A),z=y*b*S/R,M=1-z*z,C=A-2*v*f/M,isNaN(C)&&(C=0),O=d/16*M*(4+d*(4-3*M)),w=L,L=p+(1-O)*d*z*(P+O*R*(C+O*A*(2*C*C-1)))}while(Math.abs(L-w)>1e-12&&--D>0);if(0===D){const t=_,i=Math.acos(Math.sin(a)*Math.sin(l)+Math.cos(a)*Math.cos(l)*Math.cos(o-s))*t,r=o-s,c=Math.sin(r)*Math.cos(l),u=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(r),h=Math.atan2(c,u);return e.azimuth=h/n.Yr,e.distance=i,e.reverseAzimuth=void 0,e}const E=M*(c*c-u*u)/(u*u),x=E/1024*(256+E*(E*(74-47*E)-128)),T=u*(1+E/16384*(4096+E*(E*(320-175*E)-768)))*(P-x*R*(C+x/4*(A*(2*C*C-1)-x/6*C*(4*R*R-3)*(4*C*C-3)))),V=Math.atan2(b*Math.sin(L),y*f-v*b*Math.cos(L)),j=Math.atan2(y*Math.sin(L),y*f*Math.cos(L)-v*b);return e.azimuth=V/n.Yr,e.distance=T,e.reverseAzimuth=j/n.Yr,e}function b(e){return _(e)?e:(0,a.sS)(e)?c.Z.WGS84:null}},61491:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ve});var r=i(27366),s=i(7138),n=i(92026),a=i(49861),o=(i(93169),i(32718)),l=(i(84936),i(69912)),c=i(77671),u=i(98074),h=i(51817),d=i(47898),_=i(94172),p=i(32035),g=i(12400),m=i(2170),v=i(29909),y=i(79803),f=i(78952),b=i(29691),w=i(68859),M=i(67751),R=i(15559),C=i(33906),A=i(39409),P=i(47072);let S=class extends s.Z{constructor(e){super(e),this._unitNormalizer=new A.D,this._tempStartPosition=(0,g.Ue)(),this._tempEndPosition=(0,g.Ue)(),this._tempCornerPosition=(0,g.Ue)()}initialize(){const e=this.view.spatialReference,t=(0,b.rS)(e),i=t===b.GG?b.wY:t;this._sphericalPCPF=i;const r=(0,y.canProjectWithoutEngine)(e,i);this._unitNormalizer.spatialReference=r?i:e,this.addHandles([(0,_.YP)((()=>({viewData:this.viewData,startPoint:this.analysis.startPoint})),(e=>{let{viewData:t,startPoint:i}=e;t.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(i)}),_.tX),(0,_.YP)((()=>({viewData:this.viewData,endPoint:this.analysis.endPoint})),(e=>{let{viewData:t,endPoint:i}=e;t.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(i)}),_.tX),(0,_.YP)((()=>({result:this._computedResult,viewData:this.viewData})),(e=>{let{result:t,viewData:i}=e;i.result=t}),_.tX)])}_applyProjectionAndElevationAlignment(e){if(null==e)return e;const{spatialReference:t,elevationProvider:i}=this.view;return(0,C.G)(e,t,i)??((0,C.e)(this.analysis,e.spatialReference,o.Z.getLogger(this)),null)}get _computedResult(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,measurementMode:i}=this.viewData;if(null==e||null==t)return null;const r=this._euclideanDistances(e,t),s=this._geodesicDistance(e,t);let n,a;switch(i){case h.e.Auto:a=null!=s?"geodesic":"euclidean",n=s??r.horizontal;break;case h.e.Geodesic:if(null==s)return null;a="geodesic",n=s;break;case h.e.Euclidean:a="euclidean",n=r.horizontal}return{mode:a,directDistance:r.direct,horizontalDistance:n,verticalDistance:r.vertical,distance:i===h.e.Euclidean||r.horizontal.value<=P.Y?r.direct:s??r.horizontal}}_euclideanDistances(e,t){const i=e.clone();i.z=t.z;const r=this._tempStartPosition,s=this._tempEndPosition,n=this._tempCornerPosition,a=this.view.spatialReference,o=this._sphericalPCPF,l=(0,y.canProjectWithoutEngine)(a,o)?o:a;(0,w.K)(e,r,l),(0,w.K)(t,s,l),(0,w.K)(i,n,l);const c=(0,p.q)(r,s),u=(0,p.q)(n,s),h=Math.abs(t.z-e.z),_=e=>this._unitNormalizer.normalizeDistance(e),g=_(c),m=_(u),v=_(h);return{direct:(0,d.yG)(g,"meters"),horizontal:(0,d.yG)(m,"meters"),vertical:(0,d.yG)(v,"meters")}}_geodesicDistance(e,t){const{spatialReference:i}=e,r=new v.Z({spatialReference:i});r.addPath([e,t]);const s=i.isGeographic&&(0,R.Gb)(i)?(0,R.Jf)([r],"meters")[0]:i.isWebMercator?(0,m.geodesicLength)(r,"meters"):null,n=null!=s?s:this._fallbackGeodesicDistance(e,t);return null!=n?(0,d.yG)(n,"meters"):null}_fallbackGeodesicDistance(e,t){if((0,M.U)(e,G)&&(0,M.U)(t,z)){const e=new R._q;return(0,R.cA)(e,G,z,f.Z.WGS84),e.distance}return null}};(0,r._)([(0,a.Cb)()],S.prototype,"view",void 0),(0,r._)([(0,a.Cb)()],S.prototype,"analysis",void 0),(0,r._)([(0,a.Cb)()],S.prototype,"viewData",void 0),(0,r._)([(0,a.Cb)()],S.prototype,"_computedResult",null),S=(0,r._)([(0,l.j)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],S);const G=(0,g.Ue)(),z=(0,g.Ue)();i(59166);var O=i(86950),D=i(16889),L=i(58935),E=i(17842),x=i(68860),T=i(13611),V=i(55203),j=i(61201),U=i(33837),N=i(100),F=i(7025),H=i(19093),q=i(86361),Y=i(51378),Z=i(52168),k=i(70619),W=i(56529),I=i(55158),X=i(37081),Q=i(23620),B=i(93822),J=i(4760),K=i(82144),$=i(31132),ee=i(33559),te=i(78041),ie=i(27627),re=i(25920),se=i(8883),ne=i(35582),ae=i(8548),oe=i(36207);class le extends $.A{constructor(e,t,i){super(e,t,i)}initializeProgram(e){return new ie.$(e.rctx,le.shader.get().build(this.configuration),ue)}_setPipelineState(e){const t=e===re.A.NONE,i=this.configuration;return(0,oe.sm)({blending:i.transparent?t?te.wu:(0,te.j7)(e):null,polygonOffset:this.configuration.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:ae.wb.LESS},depthWrite:oe.LZ,colorWrite:oe.BK})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}get primitiveType(){return ae.MX.TRIANGLE_STRIP}}le.shader=new K.J(ne.M,(()=>i.e(14142).then(i.bind(i,14142))));class ce extends se.W{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1,this.transparencyPassType=re.A.NONE}}(0,r._)([(0,ee.o)()],ce.prototype,"polygonOffsetEnabled",void 0),(0,r._)([(0,ee.o)()],ce.prototype,"transparent",void 0),(0,r._)([(0,ee.o)({count:re.A.COUNT})],ce.prototype,"transparencyPassType",void 0);const ue=new Map([[J.T.POSITION,0],[J.T.NORMAL,1],[J.T.UV0,2],[J.T.LENGTH,3]]);class he extends W.F5{constructor(e){super(e,new _e),this._vertexAttributeLocations=ue,this.produces=new Map([[B.r.OPAQUE_MATERIAL,e=>!this._transparent&&(e===X.H_.Color||e===X.H_.Alpha)],[B.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,e=>this._transparent&&(e===X.H_.Color||e===X.H_.Alpha)]]),this._configuration=new ce}getConfiguration(e,t){return this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this._transparent,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration}intersect(){}createGLMaterial(e){return new de(e)}createBufferWriter(){return new be}get _transparent(){const{parameters:e}=this;return e.outlineColor[3]<1||e.stripeEvenColor[3]<1||e.stripeOddColor[3]<1}}class de extends Q.Z{beginSlot(e){return this.ensureTechnique(le,e)}}class _e extends W.Mt{constructor(){super(...arguments),this.width=32,this.outlineSize=.2,this.outlineColor=(0,q.al)(1,.5,0,1),this.stripeEvenColor=(0,q.al)(1,1,1,1),this.stripeOddColor=(0,q.al)(1,.5,0,1),this.stripeLength=1,this.polygonOffset=!1}}const pe=(0,I.U$)().vec3f(J.T.POSITION).vec3f(J.T.NORMAL).vec2f(J.T.UV0).f32(J.T.LENGTH),ge=(0,g.Ue)(),me=(0,g.Ue)(),ve=(0,g.Ue)(),ye=(0,g.Ue)(),fe=(0,g.Ue)();class be{constructor(){this.vertexBufferLayout=pe}elementCount(e){return 2*(e.attributes.get(J.T.POSITION).indices.length/2+1)}write(e,t,i,r,s){const{data:n,indices:a}=i.attributes.get(J.T.POSITION),o=i.attributes.get(J.T.NORMAL).data,l=n.length/3;a&&a.length!==2*(l-1)&&console.warn("MeasurementArrowMaterial does not support indices");const c=ge,u=me,h=ve,d=ye,_=fe,g=r.position,m=r.normal,v=r.uv0;let y=0;for(let b=0;b<l;++b){const i=3*b;if((0,p.s)(c,n[i],n[i+1],n[i+2]),b<l-1){const e=3*(b+1);(0,p.s)(u,n[e],n[e+1],n[e+2]),(0,p.s)(_,o[e],o[e+1],o[e+2]),(0,p.n)(_,_),(0,p.f)(h,u,c),(0,p.n)(h,h),(0,p.b)(d,_,h),(0,p.n)(d,d)}const r=(0,p.q)(c,u);e&&t&&((0,p.e)(c,c,e),(0,p.e)(u,u,e),(0,p.e)(d,d,t));const a=s+2*b,f=a+1;g.setVec(a,c),g.setVec(f,c),m.setVec(a,d),m.setVec(f,d),v.set(a,0,y),v.set(a,1,-1),v.set(f,0,y),v.set(f,1,1),b<l-1&&(y+=r)}const f=r.length;for(let p=0;p<2*l;++p)f.set(s+p,y)}}class we extends Z._{constructor(e){super(e),this._arrowWidth=16,this._arrowSubdivisions=128,this._origin=(0,g.Ue)(),this._originTransform=(0,F.Ue)(),this._arrowCenter=(0,g.Ue)(),this._renderOccluded=W.yD.OccludeAndTransparent,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._color=(0,q.Ue)(),this._contrastColor=(0,q.Ue)(),this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial&&this._arrowMaterial.setParameters({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this._stripesEnabled?this._contrastColor:this._color;this._arrowMaterial.setParameters({stripeEvenColor:e})}}get color(){return this._color}set color(e){(0,O.Ht)(e,this._color)||((0,H.c)(this._color,e),this._updateArrowColor())}get contrastColor(){return this._contrastColor}set contrastColor(e){(0,O.Ht)(e,this._color)||((0,H.c)(this._contrastColor,e),this._updateArrowColor())}createExternalResources(){const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e;this._arrowMaterial=new he({outlineColor:e,stripeEvenColor:i,stripeOddColor:e,renderOccluded:this.renderOccluded,polygonOffset:!0,isDecoration:this.isDecoration}),this._handles=new N.Z,this._handles.add((0,_.YP)((()=>this.view.state.camera),(()=>{this._viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles=(0,n.SC)(this._handles)}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){if(null==this._geometry?.startRenderSpace||null==this._geometry.endRenderSpace)return;const t=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);t.transformation=this._originTransform,e.addGeometry(t),this._viewChanged()}_createArrowGeometry(e,t,i,r){const s=this.view.renderCoordsHelper,n=[],a=[],o=(e,t)=>{const r=Y.WM.get();(0,p.f)(r,e,i),n.push(r),a.push(t)};if("euclidean"===r.type){r.eval(.5,this._arrowCenter);const i=Y.WM.get();s.worldUpAtPosition(this._arrowCenter,i),o(e,i),o(t,i)}else{r.eval(.5,this._arrowCenter);const e=this._arrowSubdivisions+1&-2;for(let t=0;t<e;++t){const i=t/(e-1),n=Y.WM.get(),a=Y.WM.get();r.eval(i,n),s.worldUpAtPosition(n,a),o(n,a)}}return(0,k.rh)(this._arrowMaterial,n,a)}_geometryChanged(){this.recreateGeometry()}_viewChanged(){if(this.view.ready&&this.attached&&null!=this._geometry){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._arrowWidth*e})}}_updateArrowColor(){if(!this.attached)return;const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e,r=e,s=e;this._arrowMaterial.setParameters({stripeEvenColor:i,outlineColor:r,stripeOddColor:s})}}var Me=i(98917),Re=i(9052),Ce=i(86700),Ae=i(11208),Pe=i(36257),Se=i(41201);let Ge=class extends s.Z{get _parameters(){const e=this.view.effectiveTheme,{accentColor:t,textColor:i}=e,r=(0,O.O)(t),s=(0,O.Ch)(t,.75),n=(0,O.O)((0,O.mj)(t)),a=(0,O.mj)(i,O.K6.Low);return{accentColor:r,contrastColor:n,translucentAccentColor:s,triangleLineWidth:3,geodesicProjectionLineWidth:2,guideLineWidth:2,guideStippleLengthPixels:3,directLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12,textColor:i,textBackgroundColor:(0,O.G)(a,.6),textCalloutColor:(0,O.G)(a,.5)}}get visible(){return this.analysisView.visible}get viewMode(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView;if(null==e||null==t||e.equals(t))return V.w.None;const i=this.analysisView.result;if(null==i)return V.w.Direct;if("geodesic"===this.actualVisualizedMeasurement)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?V.w.ProjectedGeodesic:V.w.Direct;const{verticalDistance:r,horizontalDistance:s}=i,n=r.value,a=s.value;return Math.min(n/a,a/n)<this.triangleCollapseRatioThreshold?V.w.Direct:V.w.Triangle}get actualVisualizedMeasurement(){const{measurementMode:e,result:t}=this.analysisView;switch(e){case h.e.Auto:return null!=t&&t.horizontalDistance.value>P.Y?"geodesic":"euclidean";case h.e.Euclidean:return"euclidean";case h.e.Geodesic:return"geodesic"}}get allowVisualElementsOrientationChange(){return null==this._triangleOrientationOverride}set allowVisualElementsOrientationChange(e){null==this._triangleOrientationOverride!==e&&(null==this._triangleOrientationOverride?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}get labels(){return"geodesic"===this.actualVisualizedMeasurement?{direct:null,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}constructor(e){super(e),this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=(0,g.Ue)(),this._endPosition=(0,g.Ue)(),this._cornerPosition=(0,g.Ue)(),this._startPositionAtSeaLevel=(0,g.Ue)(),this._endPositionAtSeaLevel=(0,g.Ue)(),this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.visualElementOrientation=V.x.Auto,this.triangleCollapseRatioThreshold=.03}initialize(){const e=this._parameters,t={attached:!0,view:this.view,isDecoration:!0},{guideLineWidth:i,guideStippleLengthPixels:r,triangleLineWidth:s,geodesicProjectionLineWidth:n,directLabelFontSize:a,verticalLabelFontSize:o,horizontalLabelFontSize:l}=e;this._segmentVisualElement=new we({...t,geometry:null,renderOccluded:W.yD.OccludeAndTransparent}),this._triangleVisualElement=new U.r({...t,width:s,renderOccluded:W.yD.OccludeAndTransparent}),this._rightAngleQuad=new Me.R({...t,renderOccluded:W.yD.OccludeAndTransparent});const c={...t,polygonOffset:!0,renderOccluded:W.yD.OccludeAndTransparent};this._projectedGeodesicLine=new U.r({...c,width:n,stipplePattern:(0,Ce.z5)(r)}),this._geodesicStartHint=new U.r({...c,width:i,stipplePattern:(0,Ce.z5)(r)}),this._geodesicEndHint=new U.r({...c,width:i,stipplePattern:(0,Ce.z5)(r)}),this._segmentLabel=new j.K({...t,fontSize:a}),this._verticalLabel=new j.K({...t,fontSize:o}),this._horizontalLabel=new j.K({...t,fontSize:l}),this.addHandles([(0,_.YP)((()=>{const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView,i=this.view;return{view:i,camera:i.state.camera,viewMode:this.viewMode,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,orientation:this._actualVisualElementsOrientation,visualizedMeasurement:this.actualVisualizedMeasurement,stripeLength:this._measurementArrowStripeLength}}),(e=>this._updateGeometryAndViewMode(e)),_.tX),(0,_.YP)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateVisualElementVisibility(e)),_.tX),(0,_.YP)((()=>({text:this._labelsText,visualizedMeasurement:this.actualVisualizedMeasurement})),(e=>this._updateLabelText(e)),_.tX),(0,_.YP)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateLabelVisibility(e)),_.tX),(0,_.YP)((()=>this._measurementArrowStripeLength),(e=>this._updateSegmentStripeLength(e)),_.tX),(0,Pe.qe)((async()=>this._updateMessageBundle())),(0,_.YP)((()=>this._parameters),(e=>{let{textBackgroundColor:t,textCalloutColor:i,textColor:r,translucentAccentColor:s,accentColor:n,contrastColor:a}=e;const{_segmentLabel:o,_verticalLabel:l,_horizontalLabel:c,_triangleVisualElement:u,_rightAngleQuad:h,_projectedGeodesicLine:d,_geodesicStartHint:_,_geodesicEndHint:p,_segmentVisualElement:g}=this;o.backgroundColor=t,o.calloutColor=i,o.textColor=r,l.backgroundColor=t,l.calloutColor=i,l.textColor=r,c.backgroundColor=t,c.calloutColor=i,c.textColor=r,u.color=s,h.color=s,d.color=s,_.color=s,p.color=s,g.color=n,g.contrastColor=a}),_.nn)]),this._updateMessageBundle()}destroy(){this._segmentVisualElement=(0,n.SC)(this._segmentVisualElement),this._triangleVisualElement=(0,n.SC)(this._triangleVisualElement),this._rightAngleQuad=(0,n.SC)(this._rightAngleQuad),this._projectedGeodesicLine=(0,n.SC)(this._projectedGeodesicLine),this._geodesicStartHint=(0,n.SC)(this._geodesicStartHint),this._geodesicEndHint=(0,n.SC)(this._geodesicEndHint),this._segmentLabel=(0,n.SC)(this._segmentLabel),this._verticalLabel=(0,n.SC)(this._verticalLabel),this._horizontalLabel=(0,n.SC)(this._horizontalLabel),this.set("view",null)}_updateVisualElementVisibility(e){let{visible:t,viewMode:i}=e;if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,t)switch(i){case V.w.None:break;case V.w.Direct:this._segmentVisualElement.visible=!0;break;case V.w.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case V.w.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode(e){let{view:t,camera:i,viewMode:r,elevationAlignedStartPoint:s,elevationAlignedEndPoint:n,orientation:a,visualizedMeasurement:o,stripeLength:l}=e;const c=t.renderCoordsHelper;if(null==c||null==s||null==n||s.equals(n))return;let u=this._startPosition,h=this._endPosition;c.toRenderCoords(s,u),c.toRenderCoords(n,h);const d=a===V.x.AboveSegment?1:-1,_=d*(c.getAltitude(h)-c.getAltitude(u));_<0&&(u=this._endPosition,h=this._startPosition);const p="geodesic"===o?new Re.u(this._startPosition,this._endPosition,c.spatialReference):new Re.y(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=p,this._updateSegmentStripeLength(l),r){case V.w.Direct:this._updateSegment(p,a);break;case V.w.Triangle:this._updateSegmentAndTriangle({view:t,camera:i,segment:p,orientation:a,startPosition:u,endPosition:h,deltaSign:d,altitudeDelta:_});break;case V.w.ProjectedGeodesic:this._updateSegmentAndProjection({view:t,orientation:a,startPosition:u,endPosition:h})}}_updateSegment(e,t){this._segmentLabel.anchor=t===V.x.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}_updateSegmentAndTriangle(e){let{view:{renderCoordsHelper:t},camera:i,segment:r,orientation:s,startPosition:n,endPosition:a,deltaSign:o,altitudeDelta:l}=e;const c=this._cornerPosition;t.worldUpAtPosition(n,c),(0,p.h)(c,c,o*Math.abs(l)),(0,p.g)(c,c,n),this._triangleVisualElement.geometry=[[[n[0],n[1],n[2]],[c[0],c[1],c[2]],[a[0],a[1],a[2]]]],this._rightAngleQuad.geometry={previous:n,center:c,next:a};const u=new Re.y(n,c),h=new Re.y(c,a),d=function(e,t,i,r,s){const n=Oe,a=De;s.projectToRenderScreen(i,n),s.projectToRenderScreen(t,a);const o={segment:"bottom",horizontal:"top",vertical:n[0]<a[0]?"left":"right"};{const r=Le,n=Ee;if((0,Ae.CM)(e,i,s,r),(0,Ae.CM)(e,t,s,n),(0,T.AK)(r,n)>=ze){const e=Math.sign(r[1])===Math.sign(n[1]);o.segment=e?(0,j.j)(o.vertical):o.vertical}else{const e=xe;(0,Ae.CM)(i,t,s,e),(0,T.AK)(e,n)>=ze&&(o.segment=Math.sign(e[0])===Math.sign(n[0])?(0,j.j)(o.horizontal):o.horizontal)}}if(r===V.x.BelowSegment){const e=e=>"top"===e?"bottom":"top";o.segment=e(o.segment),o.horizontal=e(o.horizontal),o.vertical=e(o.vertical)}return o}(n,a,c,s,i);this._segmentLabel.anchor=d.segment,this._segmentLabel.geometry={type:"segment",segment:r,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:u,sampleLocation:"center"},this._verticalLabel.anchor=d.vertical,this._horizontalLabel.geometry={type:"segment",segment:h,sampleLocation:"center"},this._horizontalLabel.anchor=d.horizontal}_updateSegmentAndProjection(e){let{view:{renderCoordsHelper:t},orientation:i,startPosition:r,endPosition:s}=e;t.setAltitude(this._startPositionAtSeaLevel,0,r),t.setAltitude(this._endPositionAtSeaLevel,0,s);const n=new Re.u(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(n),this._geodesicStartHint.setGeometryFromSegment(new Re.y(this._startPositionAtSeaLevel,r)),this._geodesicEndHint.setGeometryFromSegment(new Re.y(this._endPositionAtSeaLevel,s)),this._segmentLabel.geometry={type:"segment",segment:n,sampleLocation:"center"},this._segmentLabel.anchor=i===V.x.AboveSegment?"top":"bottom"}_updateLabelText(e){let{text:t,visualizedMeasurement:i}=e;null!=t?(this._segmentLabel.text="euclidean"===i?t.directDistance:t.horizontalDistance,this._horizontalLabel.text=t.horizontalDistance,this._verticalLabel.text=t.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}_updateLabelVisibility(e){let{visible:t,viewMode:i}=e;const r=this._segmentLabel,s=this._horizontalLabel,n=this._verticalLabel;if(r.visible=!1,s.visible=!1,n.visible=!1,t)switch(i){case V.w.Direct:r.visible=!0;break;case V.w.Triangle:r.visible=!0,s.visible=!0,n.visible=!0;break;case V.w.ProjectedGeodesic:r.visible=!0;case V.w.None:}}get _labelsText(){if(this.destroyed)return null;const e=this.messages,t=this.analysisView.result;if(null==t||null==e)return null;const{directDistance:i,horizontalDistance:r,verticalDistance:s}=t,n=this.analysisView.unit,a=e=>({directDistance:"",horizontalDistance:"",verticalDistance:"",...e});switch(n){case"metric":return a({directDistance:i&&(0,L.Rd)(e,i),horizontalDistance:r&&(0,L.Rd)(e,r),verticalDistance:s&&(0,L.Wv)(e,s)});case"imperial":return a({directDistance:i&&(0,L.Ud)(e,i),horizontalDistance:r&&(0,L.Ud)(e,r),verticalDistance:s&&(0,L.Zv)(e,s)});default:return a({directDistance:i&&(0,L.VG)(e,i,n),horizontalDistance:r&&(0,L.VG)(e,r,n),verticalDistance:s&&(0,L.VG)(e,s,n)})}}_updateSegmentStripeLength(e){const t=this._segmentVisualElement;null!=e?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}get _actualVisualElementsOrientation(){if(null!=this._triangleOrientationOverride)return this._triangleOrientationOverride;const e=this.visualElementOrientation;return e===V.x.Auto?this.view.state.camera.aboveGround?V.x.AboveSegment:V.x.BelowSegment:e}_requiresGeodesicGuideAt(e){const t=this.view;if(!t?.state)return!1;const i=t.state.camera,r=t.renderCoordsHelper;if(!r)return!1;const s=i.computeScreenPixelSizeAt(e);return r.getAltitude(e)/s>=10}get _measurementArrowStripeLength(){const{result:e,unit:t}=this.analysisView;if(null==e)return null;let i=null;const r=e.directDistance;switch(t){case"metric":i=r&&(0,d.nn)(r,"meters");break;case"imperial":i=r&&(0,d.nn)(r,(0,x.Q7)(r.value,r.unit));break;default:i=r&&(0,d.nn)(r,t)}return null==i?null:(0,D.sk)(i.value/30)*(0,x.En)(1,i.unit,"meters")}_updateMessageBundle(){this.loadingMessages=!0,(0,Se.ME)("esri/core/t9n/Units").then((e=>{this.messages=e})).finally((()=>{this.loadingMessages=!1}))}get testData(){return{labels:this.labels,stripeLength:this._segmentVisualElement?.stripeLength}}};(0,r._)([(0,a.Cb)()],Ge.prototype,"_parameters",null),(0,r._)([(0,a.Cb)()],Ge.prototype,"_triangleOrientationOverride",void 0),(0,r._)([(0,a.Cb)()],Ge.prototype,"messages",void 0),(0,r._)([(0,a.Cb)()],Ge.prototype,"view",void 0),(0,r._)([(0,a.Cb)()],Ge.prototype,"analysis",void 0),(0,r._)([(0,a.Cb)()],Ge.prototype,"analysisView",void 0),(0,r._)([(0,a.Cb)()],Ge.prototype,"loadingMessages",void 0),(0,r._)([(0,a.Cb)()],Ge.prototype,"visible",null),(0,r._)([(0,a.Cb)()],Ge.prototype,"viewMode",null),(0,r._)([(0,a.Cb)()],Ge.prototype,"actualVisualizedMeasurement",null),(0,r._)([(0,a.Cb)()],Ge.prototype,"visualElementOrientation",void 0),(0,r._)([(0,a.Cb)()],Ge.prototype,"triangleCollapseRatioThreshold",void 0),(0,r._)([(0,a.Cb)()],Ge.prototype,"allowVisualElementsOrientationChange",null),(0,r._)([(0,a.Cb)()],Ge.prototype,"labels",null),(0,r._)([(0,a.Cb)()],Ge.prototype,"_labelsText",null),(0,r._)([(0,a.Cb)()],Ge.prototype,"_actualVisualElementsOrientation",null),(0,r._)([(0,a.Cb)()],Ge.prototype,"_measurementArrowStripeLength",null),Ge=(0,r._)([(0,l.j)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Ge);const ze=Math.cos((0,D.Vl)(12)),Oe=(0,E.J$)(),De=(0,E.J$)(),Le=(0,E.gX)(),Ee=(0,E.gX)(),xe=(0,E.gX)();let Te=class extends((0,u.p)(s.Z)){constructor(e){super(e),this.type="direct-line-measurement-view-3d",this.analysis=null,this.result=null,this.measurementMode=h.e.Auto,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}initialize(){const e=this.view,t=this.analysis;this._analysisVisualization=new Ge({view:e,analysis:t,analysisView:this}),this._analysisController=new S({view:e,analysis:t,viewData:this})}destroy(){this._analysisController=(0,n.SC)(this._analysisController),this._analysisVisualization=(0,n.SC)(this._analysisVisualization)}get updating(){return!!this._analysisVisualization?.loadingMessages}get viewMode(){return this._analysisVisualization.viewMode}get actualVisualizedMeasurement(){return this._analysisVisualization.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisVisualization.visualElementOrientation}set visualElementOrientation(e){this._analysisVisualization.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisVisualization.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisVisualization.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}get directLabelText(){return this._analysisVisualization.labels.direct?.text??""}get horizontalLabelText(){return this._analysisVisualization.labels.horizontal?.text??""}get verticalLabelText(){return this._analysisVisualization.labels.vertical?.text??""}get unit(){return this.analysis.unit??this._defaultUnit}get testData(){return this.destroyed?{labels:null,stripeLength:null,visualization:null,controller:null}:{...this._analysisVisualization?.testData,visualization:this._analysisVisualization,controller:this._analysisController}}};(0,r._)([(0,a.Cb)()],Te.prototype,"updating",null),(0,r._)([(0,a.Cb)({readOnly:!0})],Te.prototype,"type",void 0),(0,r._)([(0,a.Cb)({constructOnly:!0,nonNullable:!0})],Te.prototype,"analysis",void 0),(0,r._)([(0,a.Cb)()],Te.prototype,"result",void 0),(0,r._)([(0,a.Cb)()],Te.prototype,"measurementMode",void 0),(0,r._)([(0,a.Cb)()],Te.prototype,"elevationAlignedStartPoint",void 0),(0,r._)([(0,a.Cb)()],Te.prototype,"elevationAlignedEndPoint",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],Te.prototype,"viewMode",null),(0,r._)([(0,a.Cb)({readOnly:!0})],Te.prototype,"actualVisualizedMeasurement",null),(0,r._)([(0,a.Cb)()],Te.prototype,"visualElementOrientation",null),(0,r._)([(0,a.Cb)()],Te.prototype,"allowVisualElementsOrientationChange",null),(0,r._)([(0,a.Cb)()],Te.prototype,"triangleCollapseRatioThreshold",null),(0,r._)([(0,a.Cb)({readOnly:!0})],Te.prototype,"directLabelText",null),(0,r._)([(0,a.Cb)({readOnly:!0})],Te.prototype,"horizontalLabelText",null),(0,r._)([(0,a.Cb)({readOnly:!0})],Te.prototype,"verticalLabelText",null),(0,r._)([(0,a.Cb)()],Te.prototype,"_analysisVisualization",void 0),(0,r._)([(0,a.Cb)()],Te.prototype,"_analysisController",void 0),(0,r._)([(0,a.Cb)()],Te.prototype,"unit",null),(0,r._)([(0,a.Cb)(c.Y)],Te.prototype,"_defaultUnit",void 0),Te=(0,r._)([(0,l.j)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],Te);const Ve=Te},55203:(e,t,i)=>{var r,s;i.d(t,{w:()=>r,x:()=>s}),function(e){e[e.None=0]="None",e[e.Direct=1]="Direct",e[e.Triangle=2]="Triangle",e[e.ProjectedGeodesic=3]="ProjectedGeodesic"}(r||(r={})),function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(s||(s={}))},51817:(e,t,i)=>{var r;i.d(t,{e:()=>r}),function(e){e[e.Auto=0]="Auto",e[e.Euclidean=1]="Euclidean",e[e.Geodesic=2]="Geodesic"}(r||(r={}))},39409:(e,t,i)=>{i.d(t,{D:()=>s});var r=i(68860);class s{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.spatialReference=e}get spatialReference(){return this._spatialReference}set spatialReference(e){e!==this._spatialReference&&(this._spatialReference=e,this._updateNormalizationFactors())}normalizeDistance(e){return e*this._metersPerDistanceUnit}normalizeElevation(e){return e*this._metersPerElevationUnit}normalizeArea(e){return e*this._squareMetersPerAreaUnit}_updateNormalizationFactors(){this._metersPerDistanceUnit=(0,r.c9)(this._spatialReference,1),this._metersPerElevationUnit=(0,r.c9)(this._spatialReference,1),this._squareMetersPerAreaUnit=this._metersPerDistanceUnit*this._metersPerDistanceUnit}}},19182:(e,t,i)=>{i.d(t,{i:()=>f});var r=i(27366),s=i(7138),n=i(79056),a=i(49861),o=(i(93169),i(32718),i(84936),i(69912)),l=i(26279),c=i(78289),u=i(78485);class h{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=l.eZ.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const t=this._resources?.layerView;t&&(t.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),t=new d({view:this._resourceFactory.view,renderGroup:this._renderGroup}),i=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new d({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},i&&(this._resources.drapeSourceRenderer=i.registerGeometryDrapeSource(t)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,c.T.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,c.T.UPDATE),this._resources.geometriesAdded=!0))}}let d=class extends((0,n.IG)(s.Z)){constructor(e){super(e),this.drapeSourceType=l.Lw.Features,this.updatePolicy=u.j.SYNC,this.renderGroup=l.eZ.Outline}};(0,r._)([(0,a.Cb)({constructOnly:!0})],d.prototype,"view",void 0),(0,r._)([(0,a.Cb)({readOnly:!0})],d.prototype,"drapeSourceType",void 0),(0,r._)([(0,a.Cb)()],d.prototype,"renderGroup",void 0),d=(0,r._)([(0,o.j)("DrapedVisualElementLayerView")],d);var _=i(86244),p=i(94172),g=i(79100),m=i(66327),v=i(97882);class y{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const t=this._resources.object;this._resources.external.forEach((t=>{t.type!==g.U.Mesh&&t.type!==g.U.Line&&t.type!==g.U.Point||e.remove(t)})),t.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,t,this._resources.layer),this._resources.external.forEach((t=>{t.type!==g.U.Mesh&&t.type!==g.U.Line&&t.type!==g.U.Point||e.add(t)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory,t=e.view,i=t._stage;if(!i)return;const r=new v.F(i,{pickable:!1,updatePolicy:u.j.SYNC}),s=new m.T({castShadow:!1}),n=e.createResources(s,r);n.forEach((e=>{i.add(e),e.type===g.U.Texture&&e.load(i.renderView.renderingContext)})),i.add(s),r.add(s);const a=e.cameraChanged,o=a?(0,p.YP)((()=>t.state.camera),(e=>a(e)),p.nn):null;this._resources={layer:r,object:s,external:n,cameraHandle:o},this._syncVisible()}_destroyResources(){if(null==this._resources)return;const e=this._resourceFactory.view._stage;e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((t=>{e.remove(t),t.type===g.U.Texture&&t.unload()}))),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class f extends _.l{constructor(e){super(e),this._isDraped=!1,this.object3dResources=new y(this.createObject3DResourceFactory(e.view)),this.drapedResources=new h(this.createDrapedResourceFactory(e.view)),this.isDraped=e.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}},52168:(e,t,i)=>{i.d(t,{_:()=>c});var r=i(29134),s=i(7025),n=i(86244),a=i(66327),o=i(78485),l=i(97882);class c extends n.l{constructor(e){super(e),this._resources=null,this._transform=(0,s.Ue)()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(e){(0,r.JG)(this._transform,e),null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null==this._resources)return;const e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,t.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const t=new l.F(e,{pickable:!1,updatePolicy:o.j.SYNC}),i=new a.T({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((t=>e.add(t))),e.add(i),t.add(i),i.visible=this.visible,this._resources={layer:t,object:i}}destroyResources(){const e=this.view._stage;null!=this._resources&&e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((t=>{e.remove(t)})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){null!=this._resources&&(this._resources.object.visible=e)}}},98917:(e,t,i)=>{i.d(t,{R:()=>M});var r=i(94172),s=i(29134),n=i(7025),a=i(32035),o=i(12400),l=i(19093),c=i(86361),u=i(51378),h=i(55946),d=i(19182),_=i(19265),p=i(91526),g=i(40779),m=i(70619),v=i(56529),y=i(39077),f=i(4760),b=i(66832),w=i(58901);class M extends d.i{constructor(e){super(e),this._maxSize=0,this._position=(0,o.Ue)(),this._up=(0,o.Ue)(),this._right=(0,o.Ue)(),this._renderOccluded=v.yD.OccludeAndTransparent,this._color=(0,c.al)(1,0,0,1),this._outlineColor=(0,c.al)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=v.yD.Opaque,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyDrapedResources(e)}}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,l.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,l.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry(e){let{previous:t,center:i,next:r}=e;this._maxSize=Math.min((0,a.q)(i,t),(0,a.q)(i,r))/3,(0,a.n)(this._up,(0,a.f)(this._up,t,i)),(0,a.n)(this._right,(0,a.f)(this._right,r,i)),(0,a.c)(this._position,i),this.recreateGeometry()}_createObject3DResources(e){const t=new b.E(this._quadMaterialParameters),i=0===this._outlineSize?void 0:new w.U(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,i),{quadMaterial:t,outlineMaterial:i,forEach:e=>{e(t),i&&e(i)}}}_createObject3DGeometries(e,t,i){if((0,a.j)(this._up,o.AG)&&(0,a.j)(this._right,o.AG))return;const r=this._createGeometries(t,i);for(const s of r)e.addGeometry(s);this._updateTransformObject3D(e)}_createDrapedResources(){const e=new b.E(this._quadMaterialParameters),t=0===this._outlineSize?void 0:new w.U(this._outlineMaterialParameters),i=this._createGeometries(e,t).map((e=>new y.z(e)));return this._setTransformDraped(i),{quadMaterial:e,outlineMaterial:t,geometries:i,pixelRatioHandle:(0,r.YP)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}))}}_destroyDrapedResources(e){e.pixelRatioHandle.remove(),e.geometries=[]}_createGeometries(e,t){const{up:i,right:r,corner:s}=this._getVertices(),n=this._quadGeometryData(i,r,s,e);return t?[n,(0,m.rh)(t,[i,s,r])]:[n]}_getVertices(){let e=this._up,t=this._right;const i=(0,a.g)(u.WM.get(),e,t);return this.isDraped&&(e=(0,a.c)(u.WM.get(),e),t=(0,a.c)(u.WM.get(),t),e[2]=0,t[2]=0,i[2]=0),{up:e,right:t,corner:i}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.object3dResources.object;if(!e)return;const t=this.view.state.camera,i=this._size*t.computeScreenPixelSizeAt(this._position),r=Math.min(this._maxSize,i);(0,s.vc)(R,this._position),(0,s.bA)(R,R,[r,r,r]),e.transformation=R}_setTransformDraped(e){if(0===e.length)return;const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:i}}}=this,{_position:r,_size:n}=this,o=(0,a.c)(u.WM.get(),r);o[2]=_.gi;const l=C;l.spatialReference=t.renderer.spatialReference,l.x=o[0],l.y=o[1];const c=n*(this.view.overlayPixelSizeInMapUnits(l)*i),h=Math.min(this._maxSize,c);(0,s.vc)(R,o),(0,s.bA)(R,R,[h,h,1]);for(const s of e)s.transformation=R}_quadGeometryData(e,t,i,r){return new g.Z(r,[[f.T.POSITION,new p.a([0,0,0,...t,...e,...i],[0,1,2,1,2,3],3,!0)]])}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters),this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters),this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}const R=(0,n.Ue)(),C=(0,h.T)(0,0,void 0,null)},86244:(e,t,i)=>{i.d(t,{l:()=>s});var r=i(94172);class s{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e.view,this._handle=(0,r.YP)((()=>e.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const i in e)i in this?"attached"===i?t=e[i]:this[i]=e[i]:console.error("Cannot set unknown property",i);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},11208:(e,t,i)=>{i.d(t,{CM:()=>c,RS:()=>u,Rs:()=>h});var r=i(17842),s=i(13611),n=i(32035),a=i(12400),o=i(55946),l=i(74509);function c(e,t,i,r){i.projectToRenderScreen(e,p),i.projectToRenderScreen(t,g),(0,s.$X)(r,g,p),(0,s.Fv)(r,r)}function u(e,t,i,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,a.Ue)();const o=(0,n.c)(_,e);return o[2]=(0,l.zx)(r,o,t,i)||0,r.renderCoordsHelper.toRenderCoords(o,t,s),s}function h(e,t,i,s){return"2d"===s.type?(d.x=e[0],d.y=e[1],d.spatialReference=t,s.toScreen(d)):(u(e,t,i,s,_),s.state.camera.projectToScreen(_,m),(0,r.vW)(m[0],m[1]))}const d=(0,o.T)(0,0,0,null),_=(0,a.Ue)(),p=(0,r.gX)(),g=(0,r.gX)(),m=(0,r.s1)()},47072:(e,t,i)=>{i.d(t,{T:()=>n,Y:()=>a});var r=i(15559),s=i(92975);function n(e,t,i,n){for(var a=arguments.length,o=new Array(a>4?a-4:0),l=4;l<a;l++)o[l-4]=arguments[l];return(0,s.sT)(e)&&(0,r.Gb)(e)?t.apply(void 0,o):(0,s.sS)(e)?i.apply(void 0,o):n.apply(void 0,o)}const a=1e5}}]);
//# sourceMappingURL=61491.d6829dee.chunk.js.map