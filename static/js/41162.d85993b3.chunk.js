"use strict";(self.webpackChunkn2_compile=self.webpackChunkn2_compile||[]).push([[41162],{72511:(e,t,i)=>{i.d(t,{S:()=>S,b:()=>b});var s=i(86361),r=i(43505),n=i(37081),o=i(33280),a=i(94951),c=i(15226),l=i(26461),h=i(116),d=i(41012),u=i(49450),_=i(95276),g=i(98634),p=i(64201),f=i(25920),v=i(4760);function b(e){const t=new p.kG,i=e.multipassEnabled&&(e.output===n.H_.Color||e.output===n.H_.Alpha);t.include(a.w,e),t.include(r.A,e),t.include(o.f5,e);const{vertex:s,fragment:b}=t;return b.include(h.Y),(0,d.Sv)(s,e),b.uniforms.add(new _.N("uColor",(e=>e.color))),t.attributes.add(v.T.POSITION,"vec3"),t.varyings.add("vWorldPosition","vec3"),i&&t.varyings.add("depth","float"),e.screenSizeEnabled&&t.attributes.add(v.T.OFFSET,"vec3"),e.shadingEnabled&&((0,d._8)(s),t.attributes.add(v.T.NORMAL,"vec3"),t.varyings.add("vViewNormal","vec3")),s.code.add(g.H`
    void main(void) {
      vWorldPosition = ${e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),e.shadingEnabled&&s.code.add(g.H`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),s.code.add(g.H`
    ${i?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),i&&t.include(c.l,e),b.code.add(g.H`
    void main() {
      discardBySlice(vWorldPosition);
      ${i?"terrainDepthTest(depth);":""}
    `),e.shadingEnabled?(b.uniforms.add(new u.J("shadingDirection",(e=>e.shadingDirection))),b.uniforms.add(new _.N("shadedColor",(e=>m(e.shadingTint,e.color)))),b.code.add(g.H`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):b.code.add(g.H`vec4 finalColor = uColor;`),b.code.add(g.H`
      ${e.output===n.H_.ObjectAndLayerIdColor?g.H`finalColor.a = 1.0;`:""}
      if (finalColor.a < ${g.H.float(l.b)}) {
        discard;
      }
      ${e.output===n.H_.Alpha?g.H`fragColor = vec4(finalColor.a);`:""}

      ${e.output===n.H_.Color?g.H`fragColor = highlightSlice(finalColor, vWorldPosition); ${e.transparencyPassType===f.A.Color?"fragColor = premultiplyAlpha(fragColor);":""}`:""}
    }
    `),t}function m(e,t){const i=1-e[3],s=e[3]+t[3]*i;return 0===s?(y[3]=s,y):(y[0]=(e[0]*e[3]+t[0]*t[3]*i)/s,y[1]=(e[1]*e[3]+t[1]*t[3]*i)/s,y[2]=(e[2]*e[3]+t[2]*t[3]*i)/s,y[3]=t[3],y)}const y=(0,s.Ue)(),S=Object.freeze(Object.defineProperty({__proto__:null,build:b},Symbol.toStringTag,{value:"Module"}))},35284:(e,t,i)=>{i.d(t,{Z:()=>M});i(59486);var s=i(41644),r=i(91505),n=i(42537),o=i(16889),a=i(92026),c=i(17842),l=i(29303),h=i(21389),d=i(29134),u=i(7025),_=i(13611),g=i(32035),p=i(12400),f=i(83448),v=i(79803),b=i(73680),m=i(96334),y=i(65156),S=i(85981),w=i(55652),T=i(40885),E=i(51378),R=i(37818),L=i(74509),O=i(77648),A=i(81703),j=i(86755),P=i(66327),D=i(78485),z=i(97882),C=i(99034),F=i(585);class M{constructor(e){this.metadata=void 0,this._camera=new j.V,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=new Array,this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,u.Ue)(),this._worldFrame=null,this._renderLocation=(0,p.Ue)(),this._renderLocationDirty=!0,this._location=new F.Z({x:0,y:0,z:0}),this._elevationAlignedLocation=new F.Z,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.consumesClicks=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=C.jg.None,this._focused=!1,this.events=new r.Z.EventEmitter,this._screenLocation={screenPointArray:(0,c.s1)(),renderScreenPointArray:(0,c.J$)(),pixelSize:0},this._screenLocationDirty=!0,this._engineResourcesAddedToStage=!1,this._attached=!1,this._location.spatialReference=e.view.spatialReference,Object.assign(this,e);const t=this.view.state?.camera;t&&this._camera.copyFrom(t)}destroy(){this._applyObjectTransform=q,this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}get _stage(){return this.view?._stage}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),(0,n.kB)((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){x(e)&&(this._screenLocationDirty=!0),(0,d.JG)(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,u.Ue)()),function(e,t,i){switch(e.viewingMode){case"local":return(0,d.yR)(i),!0;case"global":{const s=(0,f.Iu)(e.renderCoordsHelper.spatialReference);(0,m.PR)(t,0,V,0,s.radius),(0,b.y)((0,o.Vl)(V[0]),(0,o.Vl)(V[1]),i)}}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){(0,R.WG)(e,this._location),this._notifyLocationChanged()}_notifyLocationChanged(){this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){(0,R.WG)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){const e=null!=this._elevation.override?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y,this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,R.D)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;let e;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,x(this._modelTransform)){const t=this._calculateModelTransformOffset(Y);e=(0,g.g)(t,t,this.renderLocation)}else e=this.renderLocation;this._camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(e,t){if(!this.available)return null;const i=(0,c.md)(e,N),r=this._getCollisionRadius(t),n=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,_.bI)(this.screenLocation.screenPointArray,i)<r*r)return this.screenLocation.renderScreenPointArray[2]+n;break;case"line":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),s=this._calculateObjectTransform(t,H),o=r*this.screenLocation.pixelSize,a=(0,A.u4)(this._camera,i,W);if(null==a)return null;for(const i of e){if(0===i.length)continue;const e=(0,g.e)(V,i[0],s);for(let t=1;t<i.length;t++){const r=(0,g.e)(G,i[t],s),l=(0,S.Gr)((0,S.zk)(e,r,I),a);if(null!=l&&l<o*o){const t=(0,g.g)(E.WM.get(),e,r);(0,g.h)(t,t,.5);const i=(0,c.So)(E.WM.get());return this._camera.projectToRenderScreen(t,i),i[2]+n}(0,g.c)(e,r)}}break}case"disc":{const e=this.collisionType.direction,t=this.collisionType.offset??p.AG,s=this._getWorldToScreenObjectScale(),o=this._calculateObjectTransform(s,H),a=r*this.screenLocation.pixelSize,c=(0,A.u4)(this._camera,i,W);if(null==c)return null;const h=(0,l.xO)(k,o),d=(0,g.t)($,e,h),u=(0,g.e)(J,t,o);(0,w.Yq)(u,d,B);const _=Q;if((0,w.BR)(B,c,_)&&(0,g.a)(_,u)<a*a)return this.screenLocation.renderScreenPointArray[2]+n;break}case"ribbon":{const{paths:e,direction:t}=this.collisionType,s=this._getWorldToScreenObjectScale(),o=this._calculateObjectTransform(s,H),a=r*this._camera.computeScreenPixelSizeAt(this.renderLocation),h=(0,A.u4)(this._camera,i,W);if(null==h)return null;const d=(0,l.xO)(k,o),u=(0,g.t)($,t,d),_=this._calculateModelTransformPosition(J);(0,w.Yq)(_,u,B);const p=Q;if(!(0,w.BR)(B,h,p))break;for(const i of e){if(0===i.length)continue;const e=(0,g.e)(V,i[0],o);for(let t=1;t<i.length;t++){const s=(0,g.e)(G,i[t],o),r=(0,S.Jk)((0,S.zk)(e,s,I),p);if(null!=r&&r<a*a){const t=(0,g.g)(E.WM.get(),e,s);(0,g.h)(t,t,.5);const i=(0,c.So)(E.WM.get());return this._camera.projectToRenderScreen(t,i),i[2]+n}(0,g.c)(e,s)}}break}default:(0,s.Bg)(this.collisionType)}return null}attach(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}};const t=this._stage;if(!t)return;const i=e.manipulator3D;null==i.engineLayerId?(this._engineLayer=new z.F(t,{pickable:!1,updatePolicy:D.j.SYNC}),i.engineLayerId=this._engineLayer.id):t?.getObject&&(this._engineLayer=t.getObject(i.engineLayerId)),i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,null==this._materialIdReferences&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,v.canProjectWithoutEngine)(this._location.spatialReference,this.view.spatialReference)||(this.location=new F.Z({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{manipulator3D:{}}).manipulator3D;e.engineLayerReferences--;const t=0===e.engineLayerReferences;this._removeResourcesFromStage(),t&&(e.engineLayerId=null,(0,a.SC)(this._engineLayer)),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){(0,v.projectPoint)(this.location,Z,e.spatialReference)&&(0,y.Qn)(e.extent,Z)&&this._notifyLocationChanged()}_evaluateElevationAlignment(){if(null==this.elevationInfo)return;let e=null,t=0;const i=(0,L.ap)(this.elevationInfo,this.location.spatialReference??this.view.elevationProvider.spatialReference);switch(this.elevationInfo.mode){case"on-the-ground":e=(0,O.KO)(this.view.elevationProvider,this.location,"ground")??0;break;case"relative-to-ground":t=((0,O.KO)(this.view.elevationProvider,this.location,"ground")??0)+i;break;case"relative-to-scene":t=((0,O.KO)(this.view.elevationProvider,this.location,"scene")??0)+i;break;case"absolute-height":t=i}return t!==this._elevation.offset||e!==this._elevation.override?(this._elevation.offset=t,void(this._elevation.override=e)):void 0}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=H;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),s=(this.focused?C.Q9.Focused:C.Q9.Unfocused)|(this.selected?C.Q9.Selected:C.Q9.Unselected),r=this._noDisplayCount>0;for(const{stateMask:n,objects:o}of i){if(r){for(const e of o)e.visible=!1;continue}const e=(n&C.Q9.All)!==C.Q9.None,i=(n&C.jg.All)!==C.jg.None,a=!e||(s&n)==(n&C.Q9.All),c=!i||(this.state&n)==(n&C.jg.All);if(a&&c)for(const s of o)s.visible=!0,s.transformation=t;else for(const t of o)t.visible=!1}}_ensureEngineResources(){if(null==this._engineResources){const e=this._engineLayer,t=[],i=new Set;this.renderObjects.forEach((e=>{let{geometry:{material:s}}=e;i.has(s)||(t.push(s),i.add(s))}));const s=new Map;this._renderObjects.forEach((e=>{const t=new P.T({castShadow:!1,geometries:[e.geometry]}),i=s.get(e.stateMask)||[];i.push(t),s.set(e.stateMask,i)}));const r=[];s.forEach(((e,t)=>r.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:r,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){const e=this._stage;if(this._engineResourcesAddedToStage||null==this._engineResources||!e)return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;s.forEach((t=>{const i=this._materialIdReferences,s=i.get(t.id)||0;0===s&&e.add(t),i.set(t.id,s+1)})),t.forEach((t=>{let{objects:s}=t;i.addMany(s),e.addMany(s)})),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(){const e=this._stage;if(!this._engineResourcesAddedToStage||null==this._engineResources||!e)return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;t.forEach((t=>{let{objects:s}=t;i.removeMany(s),e.removeMany(s)})),s.forEach((t=>{const i=this._materialIdReferences,s=i.get(t.id);1===s?(e.remove(t),i.delete(t.id)):i.set(t.id,s-1)})),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,U);return(0,g.s)(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return(0,g.f)(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return(0,d.t8)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&(0,d.Jp)(t,t,this._worldFrame),(0,d.Jp)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,null!=this._applyObjectTransform&&this._applyObjectTransform(t),t}get test(){let e=!1;if(null!=this._engineResources)for(const t of this._engineResources.objectsByState){for(const i of t.objects)if(i.visible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function x(e){return 0!==e[12]||0!==e[13]||0!==e[14]}const N=(0,c.s1)(),I=(0,S.Ue)(),W=(0,T.Ue)(),k=(0,h.Ue)(),U=(0,u.Ue)(),H=(0,u.Ue)(),B=(0,w.Ue)(),V=(0,p.Ue)(),G=(0,p.Ue)(),Q=(0,p.Ue)(),$=(0,p.Ue)(),J=(0,p.Ue)(),Y=(0,p.Ue)(),Z=new F.Z({x:0,y:0,z:0,spatialReference:null}),q=()=>{}},40508:(e,t,i)=>{i.d(t,{r:()=>r});var s=i(99034);class r{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.Q9.None;this.geometry=e,this.stateMask=t}}},83639:(e,t,i)=>{i.d(t,{Aq:()=>p,EA:()=>d,Gd:()=>g,X9:()=>_,rotateManipulatorDefaults:()=>u});var s=i(86950),r=i(29134),n=i(32035),o=i(51378),a=(i(37818),i(96387),i(68401)),c=i(56529),l=i(66832),h=i(11606);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.yD.OccludeAndTransparent,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=(0,s.gp)(e),n=!(e[3]<1);return i?new h.Q({color:r,writeDepth:n,cullFace:a.Vr.Back,renderOccluded:t,isDecoration:!0}):new l.E({color:r,writeDepth:n,cullFace:a.Vr.Back,renderOccluded:t,isDecoration:!0})}const u=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1}),_=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function g(e,t,i,s){const a=(0,n.f)(o.WM.get(),e,i),c=p(a,(0,n.b)(o.WM.get(),s,a),i,o.MP.get());(0,r.U_)(c,c);const l=(0,n.e)(o.WM.get(),t,c);return Math.atan2(l[1],l[0])}function p(e,t,i,s){const r=(0,n.n)(o.WM.get(),e),a=(0,n.n)(o.WM.get(),t),c=(0,n.b)(o.WM.get(),r,a);return s[0]=r[0],s[1]=r[1],s[2]=r[2],s[3]=0,s[4]=a[0],s[5]=a[1],s[6]=a[2],s[7]=0,s[8]=c[0],s[9]=c[1],s[10]=c[2],s[11]=0,s[12]=i[0],s[13]=i[1],s[14]=i[2],s[15]=1,s}},52168:(e,t,i)=>{i.d(t,{_:()=>l});var s=i(29134),r=i(7025),n=i(86244),o=i(66327),a=i(78485),c=i(97882);class l extends n.l{constructor(e){super(e),this._resources=null,this._transform=(0,r.Ue)()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(e){(0,s.JG)(this._transform,e),null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null==this._resources)return;const e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,t.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const t=new c.F(e,{pickable:!1,updatePolicy:a.j.SYNC}),i=new o.T({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),e.addMany(i.geometries),this.forEachExternalMaterial((t=>e.add(t))),e.add(i),t.add(i),i.visible=this.visible,this._resources={layer:t,object:i}}destroyResources(){const e=this.view._stage;null!=this._resources&&e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((t=>{e.remove(t)})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){null!=this._resources&&(this._resources.object.visible=e)}}},86244:(e,t,i)=>{i.d(t,{l:()=>r});var s=i(94172);class r{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(e){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e.view,this._handle=(0,s.YP)((()=>e.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const i in e)i in this?"attached"===i?t=e[i]:this[i]=e[i]:console.error("Cannot set unknown property",i);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}},43505:(e,t,i)=>{i.d(t,{A:()=>o});var s=i(41012),r=i(58406),n=i(98634);function o(e,t){if(!t.screenSizeEnabled)return;const i=e.vertex;(0,s.hY)(i,t),i.uniforms.add(new r.p("perScreenPixelRatio",((e,t)=>t.camera.perScreenPixelRatio)),new r.p("screenSizeScale",(e=>e.screenSizeScale))),i.code.add(n.H`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}},11606:(e,t,i)=>{i.d(t,{Q:()=>z});var s=i(32035),r=i(12400),n=i(86361),o=i(41414),a=i(25158),c=i(55158),l=i(37081),h=i(68401),d=i(23620),u=i(56529),_=i(93822),g=i(97731),p=i(4760),f=i(33236),v=i(22909),b=i(27366),m=i(82144),y=i(31132),S=i(33559),w=i(78041),T=i(27627),E=i(25920),R=i(8883),L=i(72511),O=i(8548),A=i(36207);class j extends y.A{initializeProgram(e){return new T.$(e.rctx,j.shader.get().build(this.configuration),D)}_setPipelineState(e){const t=this.configuration,i=e===E.A.NONE,s=e===E.A.FrontFace;return(0,A.sm)({blending:t.output!==l.H_.Color&&t.output!==l.H_.Alpha||!t.transparent?null:i?w.wu:(0,w.j7)(e),culling:(0,A.zp)(t.cullFace),depthTest:{func:s?O.wb.LESS:t.shadingEnabled?O.wb.LEQUAL:O.wb.LESS},depthWrite:i?t.writeDepth?A.LZ:null:(0,w.K5)(e),colorWrite:A.BK,polygonOffset:i||s?null:w.E0})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}j.shader=new m.J(L.S,(()=>i.e(36556).then(i.bind(i,36556))));class P extends R.W{constructor(){super(...arguments),this.output=l.H_.Color,this.cullFace=h.Vr.None,this.transparencyPassType=E.A.NONE,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.multipassEnabled=!1,this.cullAboveGround=!1}}(0,b._)([(0,S.o)({count:l.H_.COUNT})],P.prototype,"output",void 0),(0,b._)([(0,S.o)({count:h.Vr.COUNT})],P.prototype,"cullFace",void 0),(0,b._)([(0,S.o)({count:E.A.COUNT})],P.prototype,"transparencyPassType",void 0),(0,b._)([(0,S.o)()],P.prototype,"hasSlicePlane",void 0),(0,b._)([(0,S.o)()],P.prototype,"transparent",void 0),(0,b._)([(0,S.o)()],P.prototype,"writeDepth",void 0),(0,b._)([(0,S.o)()],P.prototype,"screenSizeEnabled",void 0),(0,b._)([(0,S.o)()],P.prototype,"shadingEnabled",void 0),(0,b._)([(0,S.o)()],P.prototype,"multipassEnabled",void 0),(0,b._)([(0,S.o)()],P.prototype,"cullAboveGround",void 0),(0,b._)([(0,S.o)({constValue:!1})],P.prototype,"occlusionPass",void 0);const D=new Map([[p.T.POSITION,0],[p.T.NORMAL,1],[p.T.OFFSET,2]]);class z extends u.F5{constructor(e){super(e,new F),this.supportsEdges=!0,this.produces=new Map([[_.r.OPAQUE_MATERIAL,e=>e===l.H_.Highlight||(0,l.aN)(e)&&!this._isTransparent],[_.r.TRANSPARENT_MATERIAL,e=>(0,l.aN)(e)&&this._isTransparent&&this.parameters.writeDepth],[_.r.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,e=>(0,l.aN)(e)&&this._isTransparent&&!this.parameters.writeDepth]]),this._configuration=new P,this._vertexAttributeLocations=D}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._isTransparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.multipassEnabled=t.multipassEnabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,i,r,n,a){if(this.parameters.screenSizeEnabled){const t=e.attributes.get(p.T.OFFSET),c={applyToVertex:(e,r,n,o)=>{const a=(0,s.s)(x,t.data[3*o],t.data[3*o+1],t.data[3*o+2]),c=(0,s.s)(N,e,r,n);return(0,s.h)(a,a,this.parameters.screenSizeScale*i.camera.computeScreenPixelSizeAt(a)),(0,s.g)(c,c,a),[c[0],c[1],c[2]]},applyToAabb:e=>{const t=(0,o.be)(e,x);return(0,o.bA)(e,this.parameters.screenSizeScale*i.camera.computeScreenPixelSizeAt(t))}};(0,v.Bw)(e,i,r,n,c,a)}else(0,v.Bw)(e,i,r,n,void 0,a)}createGLMaterial(e){return new C(e)}createBufferWriter(){return new M(this.parameters.screenSizeEnabled)}get _isTransparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}}class C extends d.Z{beginSlot(e){return this.ensureTechnique(j,e)}}class F extends u.Mt{constructor(){super(...arguments),this.color=(0,n.al)(1,1,1,1),this.shadingTint=(0,n.al)(0,0,0,.25),this.shadingDirection=(0,s.n)((0,r.Ue)(),[.5,-.5,-.5]),this.screenSizeScale=14,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=h.Vr.None,this.screenSizeEnabled=!1,this.shadingEnabled=!0}}class M{constructor(e){this.screenSizeEnabled=e;const t=(0,c.U$)().vec3f(p.T.POSITION).vec3f(p.T.NORMAL);this.screenSizeEnabled&&t.vec3f(p.T.OFFSET),this.vertexBufferLayout=t}elementCount(e){return e.attributes.get(p.T.POSITION).indices.length}write(e,t,i,s,r){if((0,f.NK)(i,this.vertexBufferLayout,e,t,s,r),this.screenSizeEnabled){if(!i.attributes.has(p.T.OFFSET))throw new Error(`${p.T.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);{const e=i.attributes.get(p.T.OFFSET);(0,g.hu)(3===e.size);const n=s.getField(p.T.OFFSET,a.ct);if(!n)throw new Error("unable to acquire view for "+p.T.OFFSET);(0,f.ho)(e,t,n,r)}}}}const x=(0,r.Ue)(),N=(0,r.Ue)()},86509:(e,t,i)=>{i.d(t,{f:()=>a});var s=i(27366),r=i(94172),n=(i(32718),i(93169),i(84936),i(10064),i(69912)),o=i(45900);let a=class extends o.m{constructor(e){super(e)}initialize(){this.addHandles((0,r.YP)((()=>this.analysisViewData.visible),(e=>this.visible=e),r.tX))}deactivate(){this.onDeactivate(),this.created||this.analysis.clear()}resetCreated(){this._set("created",!1)}};a=(0,s._)([(0,n.j)("esri.views.interactive.AnalysisToolBase")],a)}}]);
//# sourceMappingURL=41162.d85993b3.chunk.js.map