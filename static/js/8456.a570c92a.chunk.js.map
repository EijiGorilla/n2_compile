{"version":3,"file":"static/js/8456.a570c92a.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/layers/ImageryLayerView.js","../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Error.js\";import{throwIfAborted as r}from\"../../core/promiseUtils.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import p from\"../../geometry/Point.js\";import{combinedViewLayerTimeExtentProperty as i}from\"../../layers/support/commonProperties.js\";import a from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as n}from\"./support/popupUtils.js\";const u=u=>{let m=class extends u{constructor(){super(...arguments),this.view=null}async fetchPopupFeaturesAtLocation(e,o){const{layer:s}=this;if(!e)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:i}=s,u=n(s,o);if(!i||null==u)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Missing required popupTemplate or popupEnabled\",{popupEnabled:i,popupTemplate:u});const m=await u.getRequiredFields();r(o);const c=new a;c.timeExtent=this.timeExtent,c.geometry=e,c.outFields=m,c.outSpatialReference=e.spatialReference;const{resolution:l,spatialReference:y}=this.view,d=\"2d\"===this.view.type?new p(l,l,y):new p(.5*l,.5*l,y),{returnTopmostRaster:h,showNoDataRecords:w}=u.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},f={returnDomainValues:!0,returnTopmostRaster:h,pixelSize:d,showNoDataRecords:w,signal:o?.signal};return s.queryVisibleRasters(c,f).then((e=>e))}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([o()],m.prototype,\"layer\",void 0),e([o()],m.prototype,\"suspended\",void 0),e([o(i)],m.prototype,\"timeExtent\",void 0),e([o()],m.prototype,\"view\",void 0),m=e([s(\"esri.views.layers.ImageryLayerView\")],m),m};export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.29/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as t}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DynamicLayerView3D.js\";import s from\"../../layers/ImageryLayerView.js\";let n=class extends(s(r)){constructor(){super(...arguments),this.type=\"imagery-3d\",this.redrawDebounced=a((async e=>{this.redraw(((e,a)=>this._redrawImage(e,a)),e)}),2e3)}initialize(){this.addHandles([t((()=>this.view.basemapTerrain.ready),(()=>this._initializeMaximumDataResolution()),{once:!0,initial:!0}),this.layer.on(\"redraw\",(()=>this._updatingHandles.addPromise(this.redrawDebounced())))]),this._updatingHandles.add((()=>this.layer?.exportImageServiceParameters?.version),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.layer?.renderer),(()=>{this._updatingHandles.addPromise(this.refreshDebounced())})),this._updatingHandles.add((()=>this.timeExtent),(()=>this._updatingHandles.addPromise(this.refreshDebounced())))}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}getFetchOptions(){return{timeExtent:this.timeExtent}}async processResult(e,a,t){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,t))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const t=e.image,i=t.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:a}),s=this.layer.applyFilter(r).pixelBlock;if(null==s)throw new Error;t.width=s.width,t.height=s.height;const n=i.createImageData(s.width,s.height);n.data.set(s.getAsRGBA()),i.putImageData(n,0,0)}};n=e([i(\"esri.views.3d.layers.ImageryLayerView3D\")],n);const o=n;export{o as default};\n"],"names":["u","m","constructor","super","arguments","this","view","fetchPopupFeaturesAtLocation","e","o","layer","s","t","popupEnabled","i","n","popupTemplate","getRequiredFields","r","c","a","timeExtent","geometry","outFields","outSpatialReference","spatialReference","resolution","l","y","d","type","p","returnTopmostRaster","h","showNoDataRecords","w","layerOptions","f","returnDomainValues","pixelSize","signal","queryVisibleRasters","then","canResume","isEmpty","prototype","redrawDebounced","async","redraw","_redrawImage","initialize","addHandles","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","on","_updatingHandles","addPromise","add","exportImageServiceParameters","version","refreshDebounced","renderer","maximumDataResolution","loaded","serviceRasterInfo","getFetchOptions","processResult","imageOrCanvasElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","getContext","applyRenderer","applyFilter","pixelBlock","width","height","createImageData","data","set","getAsRGBA","putImageData"],"sourceRoot":""}